Namespace(include_mlx_gpu=1, include_mlx_gpu_compile=1, include_mlx_cpu=1, include_mps=1, include_cpu=0, include_cuda=0)
Use MLX: True

Running benchmarks on mlx_gpu (1/4)

Running benchmarks on mlx_gpu_compile (2/4)

Running benchmarks on mlx_cpu (3/4)

Running benchmarks on mps (4/4)

Detailed benchmark:
| Operation                                           | mlx_gpu | mlx_gpu_compile | mlx_cpu | mps | mlx_gpu_compile/mlx_gpu speedup | mlx_gpu/mps speedup | mlx_gpu/mlx_cpu speedup |
|-----------------------------------------------------|-------|---------------|-------|------|-------------------------------|-------------------|-----------------------|
| Argmax / dim=64x1024x128 axi=0                  |   1.71 |   1.73 |  10.74 |   1.91 |      0% |    +11% |   +527% |
| Argmax / dim=64x1024x128 axi=1                  |   1.71 |   1.80 |  10.60 |   1.49 |     -5% |    -12% |   +521% |
| Argmax / dim=64x1024x128 axi=2                  |   1.71 |   1.92 |  10.57 |   1.40 |    -11% |    -18% |   +518% |
| Argmax / dim=64x128x1024 axi=2                  |   1.80 |   1.89 |  10.63 |   0.88 |     -4% |    -51% |   +491% |
| BCE / dim=1000000 dim=1000000                   |   0.95 |   0.51 |   7.95 |   0.42 |    +83% |    -55% |   +739% |
| BCE / dim=100000x32 dim=100000x32               |   2.86 |   1.11 |  26.01 |   0.80 |   +156% |    -71% |   +808% |
| BCE / dim=100000x64x2 dim=100000x64x2           |  10.10 |   3.89 | 103.60 |   2.10 |   +159% |    -79% |   +925% |
| BCE / dim=128x100000 dim=128x100000             |   9.84 |   3.84 | 103.57 |   2.23 |   +156% |    -77% |   +952% |
| Concat / dim=1000000x64 dim=1000000x32 axi=1    |  13.24 |  13.07 |  63.67 |  13.32 |     +1% |     +0% |   +381% |
| Concat / dim=1000000x64 dim=1000000x128 axi=1   |  26.66 |  26.70 | 140.16 |  25.99 |      0% |     -2% |   +425% |
| Concat / dim=1000000x64 dim=1000000x64 axi=0    |  17.42 |  17.33 |  60.75 |  17.73 |     +0% |     +1% |   +248% |
| Concat / dim=64x1000000 dim=64x1000000 axi=0    |  17.22 |  17.26 |  82.44 |  18.06 |      0% |     +4% |   +378% |
| Conv1d / dim=100x256x3 dim=8x3x3                |   0.62 |   0.47 |   0.34 |   0.33 |    +32% |    -46% |    -45% |
| Conv1d / dim=100x256x256 dim=8x3x256            |   6.85 |   6.84 |   9.99 |   2.50 |     +0% |    -63% |    +45% |
| Conv1d / dim=16x1000x80 dim=128x11x80           |   5.44 |   5.44 |   6.61 |   2.89 |      0% |    -46% |    +21% |
| Conv1d / dim=16x1000x3 dim=128x11x3             |   0.86 |   0.71 |   0.55 |   0.63 |    +21% |    -26% |    -36% |
| Conv2d / dim=100x256x256x3 dim=8x3x3x3          |  17.56 |  17.64 | 1287.28 |  10.88 |      0% |    -38% |  +7231% |
| Conv2d / dim=10x256x256x12 dim=8x3x3x12         |  35.30 |  35.17 | 517.84 |   5.66 |     +0% |    -83% |  +1366% |
| Conv2d / dim=1x256x256x128 dim=8x3x3x128        |   1.94 |   2.06 | 728.96 |  11.20 |     -6% |   +478% | +37560% |
| Conv2d / dim=100x28x28x3 dim=8x3x3x3            |   0.44 |   0.48 |  13.93 |   0.54 |     -7% |    +23% |  +3063% |
| Conv2d / dim=1000x28x28x3 dim=8x3x3x3           |   2.11 |   2.09 | 139.49 |   1.82 |     +0% |    -13% |  +6514% |
| Gather / dim=64x256 dim=10                      |   0.14 |   0.18 |   0.02 |   0.18 |    -20% |    +25% |    -85% |
| Gather / dim=64x256 dim=1000                    |   0.26 |   0.21 |   0.04 |   0.30 |    +22% |    +15% |    -83% |
| Gather / dim=64x256 dim=1000000                 |  32.31 |  34.56 |  22.78 | 250.52 |     -6% |   +675% |    -29% |
| Gather / dim=1024x32 dim=10                     |   0.26 |   0.25 |   0.02 |   0.15 |     +3% |    -41% |    -93% |
| Gather / dim=1024x32 dim=1000                   |   0.25 |   0.22 |   0.03 |   0.20 |    +17% |    -19% |    -89% |
| Gather / dim=1024x32 dim=1000000                |   4.52 |   4.50 |   6.64 |  27.82 |     +0% |   +514% |    +46% |
| LeakyReLU / dim=128x16x1024                     |   0.50 |   0.55 |   0.33 |   0.53 |    -10% |     +5% |    -32% |
| LeakyReLU / dim=64x128x1024                     |   1.38 |   1.45 |   1.39 |   1.40 |     -5% |     +1% |     +1% |
| Linear / dim=100x1024x32 dim=32x1024 dim=1024   |   7.77 |   9.93 |  44.42 |  13.33 |    -21% |    +71% |   +471% |
| Linear / dim=100x1024x64 dim=64x1024 dim=1024   |   8.26 |   8.63 |  49.47 |  20.89 |     -4% |   +152% |   +498% |
| Linear / dim=100x1024x256 dim=256x1024 dim=1024 |  26.28 |  26.27 |  78.19 |  77.76 |     +0% |   +195% |   +197% |
| Linear / dim=100x1024x512 dim=512x1024 dim=1024 |  50.42 |  50.44 | 122.25 | 151.75 |      0% |   +200% |   +142% |
| Linear / dim=100x1x51200 dim=51200x1 dim=1      |   0.85 |   0.87 |   0.41 |   0.65 |     -2% |    -22% |    -51% |
| MatMul / dim=32x1x1000 dim=32x1000x128          |   0.49 |   0.66 |   0.83 |   0.55 |    -24% |    +11% |    +68% |
| MatMul / dim=1000x64x256 dim=256x32             |   1.69 |   1.85 |   4.83 |  72.39 |     -8% |  +4187% |   +186% |
| MatMul / dim=1000x64x1024 dim=1000x1024x32      |   7.61 |   7.57 |  44.43 |  20.42 |     +0% |   +168% |   +483% |
| MatMul / dim=1000x1024x64 dim=1000x64x256       |  25.07 |  24.83 |  81.09 |  25.29 |     +0% |     +0% |   +223% |
| MatMul / dim=64x1000000 dim=1000000x32          |  25.94 |  25.03 |  24.98 | 411.27 |     +3% |  +1485% |     -3% |
| MatMul / dim=1000000x64 dim=64x1024             | 15890.87 | 13460.32 | 7324.94 | 9103.75 |    +18% |    -42% |    -53% |
| PReLU / dim=128x16x1024 dim=1                   |   0.48 |   0.54 |   1.36 |   0.54 |    -10% |    +12% |   +182% |
| PReLU / dim=64x128x1024 dim=1                   |   1.38 |   1.45 |   5.42 |   1.48 |     -5% |     +7% |   +293% |
| ReLU / dim=128x16x1024                          |   0.46 |   0.51 |   0.23 |   0.52 |     -8% |    +11% |    -49% |
| ReLU / dim=64x128x1024                          |   1.33 |   1.40 |   1.18 |   1.43 |     -4% |     +7% |    -11% |
| Scatter / dim=64x16 dim=10                      |   0.14 |   0.17 |   0.02 |   0.13 |    -13% |     -7% |    -87% |
| Scatter / dim=64x16 dim=1000                    |   0.14 |   0.16 |   0.08 |   0.14 |    -15% |     +3% |    -41% |
| Scatter / dim=64x16 dim=1000000                 |   1.34 |   1.52 |  65.19 |  13.21 |    -12% |   +888% |  +4779% |
| Scatter / dim=1024x32 dim=10                    |   0.16 |   0.17 |   0.02 |   0.20 |     -6% |    +26% |    -85% |
| Scatter / dim=1024x32 dim=1000                  |   0.14 |   0.17 |   0.14 |   0.19 |    -13% |    +31% |     -2% |
| Scatter / dim=1024x32 dim=1000000               |   2.45 |   2.53 | 118.29 |  27.10 |     -3% |  +1008% |  +4735% |
| ScatterSum / dim=64x16 dim=10                   |   0.03 |   0.03 |   0.02 |    nan |    -25% |    nan% |    -34% |
| ScatterSum / dim=64x16 dim=1000                 |   0.03 |   0.04 |   0.02 |    nan |    -31% |    nan% |    -40% |
| ScatterSum / dim=64x16 dim=1000000              |   0.03 |   0.03 |   0.02 |    nan |    -14% |    nan% |    -40% |
| ScatterSum / dim=1024x32 dim=10                 |   0.03 |   0.03 |   0.01 |    nan |    -21% |    nan% |    -43% |
| ScatterSum / dim=1024x32 dim=1000               |   0.02 |   0.03 |   0.02 |    nan |    -12% |    nan% |    -38% |
| ScatterSum / dim=1024x32 dim=1000000            |   0.03 |   0.03 |   0.02 |    nan |    -19% |    nan% |    -34% |
| ScatterMax / dim=64x16 dim=10                   |   0.03 |   0.03 |   0.02 |    nan |    -19% |    nan% |    -35% |
| ScatterMax / dim=64x16 dim=1000                 |   0.02 |   0.03 |   0.02 |    nan |    -17% |    nan% |    -33% |
| ScatterMax / dim=64x16 dim=1000000              |   0.02 |   0.03 |   0.02 |    nan |    -16% |    nan% |    -35% |
| ScatterMax / dim=1024x32 dim=10                 |   0.02 |   0.03 |   0.02 |    nan |    -18% |    nan% |    -34% |
| ScatterMax / dim=1024x32 dim=1000               |   0.04 |   0.03 |   0.02 |    nan |     +6% |    nan% |    -54% |
| ScatterMax / dim=1024x32 dim=1000000            |   0.03 |   0.03 |   0.01 |    nan |    -10% |    nan% |    -46% |
| SeLU / dim=128x16x1024                          |   0.51 |   0.51 |   2.01 |   0.52 |      0% |     +3% |   +297% |
| SeLU / dim=64x128x1024                          |   1.49 |   1.46 |   7.91 |   1.40 |     +2% |     -6% |   +431% |
| Sigmoid / dim=128x16x1024                       |   0.63 |   0.50 |   1.86 |   0.53 |    +26% |    -16% |   +195% |
| Sigmoid / dim=64x128x1024                       |   1.51 |   1.42 |   8.04 |   1.40 |     +6% |     -7% |   +431% |
| Softmax / dim=64x1000000 axi=-1                 |  38.44 |  26.48 |  60.26 |  17.35 |    +45% |    -54% |    +56% |
| Softmax / dim=1000000x64 axi=-1                 |  35.33 |  25.58 |  60.15 |  21.19 |    +38% |    -40% |    +70% |
| Softmax / dim=64x16x32x1024 axi=-1              |  18.59 |  14.47 |  30.96 |  11.49 |    +28% |    -38% |    +66% |
| Softmax / dim=128x16x32x1024 axi=-1             |  36.71 |  27.17 |  61.69 |  23.15 |    +35% |    -36% |    +68% |
| Softmax / dim=1024x16x32x128 axi=-1             |  35.99 |  26.27 |  61.91 |  35.58 |    +37% |     -1% |    +72% |
| Softmax / dim=1024x64x32x8 axi=-1               |   9.86 |   7.11 |  15.71 |   6.52 |    +38% |    -33% |    +59% |
| Softplus / dim=128x16x1024                      |   0.67 |   0.49 |  14.73 |   0.57 |    +36% |    -16% |  +2083% |
| Softplus / dim=64x128x1024                      |   1.38 |   1.38 |  60.28 |   1.68 |     +0% |    +21% |  +4265% |
| Sort / dim=64x128x1024 axi=0                    |   3.14 |   3.20 | 260.36 |  69.01 |     -1% |  +2096% |  +8187% |
| Sort / dim=64x128x1024 axi=1                    |   3.31 |   3.23 | 259.80 |  83.55 |     +2% |  +2426% |  +7754% |
| Sort / dim=64x128x1024 axi=2                    |   3.38 |   3.19 | 258.34 |  36.90 |     +6% |   +991% |  +7541% |
| Sum / dim=64x128x128x128 axi=0                  |   8.93 |   9.19 |   9.67 |  17.69 |     -2% |    +98% |     +8% |
| Sum / dim=64x128x128x128 axi=1                  |   8.65 |   8.80 |   8.88 |  10.37 |     -1% |    +19% |     +2% |
| Sum / dim=64x128x128x128 axi=2                  |   8.89 |   8.50 |   9.14 |  10.02 |     +4% |    +12% |     +2% |
| Sum / dim=64x128x128x128 axi=3                  |   8.72 |   8.48 |   8.83 |  11.58 |     +2% |    +32% |     +1% |
| SumAll / dim=64x128x128x128                     |   8.74 |   8.54 |   8.73 |   9.30 |     +2% |     +6% |      0% |
| SumAll / dim=1000000                            |   0.29 |   0.23 |   0.07 |   0.28 |    +26% |     -3% |    -77% |
| SumAll / dim=1000000x128                        |   8.93 |   8.15 |   8.51 |   9.12 |     +9% |     +2% |     -4% |
| SumAll / dim=128x1000000                        |   8.31 |   8.15 |   8.49 |   9.00 |     +1% |     +8% |     +2% |

 Average benchmark:
| Operation       | mlx_gpu | mlx_gpu_compile | mlx_cpu | mps | mlx_gpu_compile/mlx_gpu speedup | mlx_gpu/mps speedup | mlx_gpu/mlx_cpu speedup |
|-----------------|-------|---------------|-------|------|-------------------------------|-------------------|-----------------------|
| Argmax      |   1.73 |   1.84 |  10.63 |   1.42 |     -5% |    -18% |   +514% |
| BCE         |   5.94 |   2.34 |  60.28 |   1.39 |   +153% |    -76% |   +915% |
| Concat      |  18.63 |  18.59 |  86.76 |  18.78 |     +0% |     +0% |   +365% |
| Conv1d      |   3.44 |   3.37 |   4.37 |   1.59 |     +2% |    -53% |    +26% |
| Conv2d      |  11.47 |  11.49 | 537.50 |   6.02 |      0% |    -47% |  +4586% |
| Gather      |   6.29 |   6.65 |   4.92 |  46.53 |     -5% |   +639% |    -21% |
| LeakyReLU   |   0.94 |   1.00 |   0.86 |   0.96 |     -6% |     +2% |     -7% |
| Linear      |  18.71 |  19.23 |  58.95 |  52.88 |     -2% |   +182% |   +214% |
| MatMul      | 2658.61 | 2253.38 | 1246.85 | 1605.61 |    +17% |    -39% |    -53% |
| PReLU       |   0.93 |   1.00 |   3.39 |   1.01 |     -6% |     +8% |   +264% |
| ReLU        |   0.90 |   0.95 |   0.71 |   0.97 |     -5% |     +8% |    -21% |
| Scatter     |   0.73 |   0.79 |  30.62 |   6.83 |     -7% |   +837% |  +4105% |
| ScatterSum  |   0.03 |   0.03 |   0.02 |    nan |    -21% |    nan% |    -38% |
| ScatterMax  |   0.03 |   0.03 |   0.02 |    nan |    -12% |    nan% |    -41% |
| SeLU        |   1.00 |   0.99 |   4.96 |   0.96 |     +1% |     -3% |   +397% |
| Sigmoid     |   1.07 |   0.96 |   4.95 |   0.96 |    +11% |    -10% |   +362% |
| Softmax     |  29.15 |  21.18 |  48.45 |  19.21 |    +37% |    -34% |    +66% |
| Softplus    |   1.03 |   0.94 |  37.51 |   1.12 |     +9% |     +9% |  +3549% |
| Sort        |   3.28 |   3.21 | 259.50 |  63.15 |     +2% |  +1827% |  +7819% |
| Sum         |   8.79 |   8.74 |   9.13 |  12.42 |     +0% |    +41% |     +3% |
| SumAll      |   6.56 |   6.27 |   6.45 |   6.92 |     +4% |     +5% |     -1% |
